{"ast":null,"code":"import React,{useState,useEffect}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';// Layout\nimport Layout from'./components/layout/Layout';// Pages\nimport LandingPage from'./components/pages/LandingPage';import LoginPage from'./components/pages/LoginPage';import AdminLoginPage from'./components/pages/AdminLoginPage';import SignupPage from'./components/pages/SignupPage';import InvitationPage from'./components/pages/InvitationPage';import ErrorPage from'./components/pages/ErrorPage';// Dashboards\nimport UserDashboard from'./components/user/UserDashboard';import AdminDashboard from'./components/admin/AdminDashboard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[watchlists,setWatchlists]=useState([]);const[sectorData,setSectorData]=useState({});useEffect(()=>{// Check for existing session\nfetchUserData();},[]);const fetchUserData=async()=>{try{const response=await fetch('/api/auth/me');if(response.ok){const data=await response.json();setUser(data.user);setWatchlists(data.watchlists||[]);setSectorData(data.sectorData||{});}}catch(error){console.error('Failed to fetch user data:',error);}finally{setLoading(false);}};const handleLogin=userData=>{setUser(userData);fetchUserData();// Refresh all data after login\n};const handleLogout=()=>{setUser(null);setWatchlists([]);setSectorData({});};// Protected Route Component\nconst ProtectedRoute=_ref=>{let{children,adminOnly=false}=_ref;if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center align-items-center\",style:{minHeight:'50vh'},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})})});}if(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}if(adminOnly&&!user.is_admin){return/*#__PURE__*/_jsx(ErrorPage,{code:\"403\",title:\"Access Forbidden\",message:\"You don't have permission to access this page.\"});}return children;};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center align-items-center\",style:{minHeight:'100vh'},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})})});}return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:user?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:user?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true}):/*#__PURE__*/_jsx(Layout,{user:user,onLogout:handleLogout,children:/*#__PURE__*/_jsx(LoginPage,{onLogin:handleLogin})})}),/*#__PURE__*/_jsx(Route,{path:\"/signup\",element:user?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true}):/*#__PURE__*/_jsx(Layout,{user:user,onLogout:handleLogout,children:/*#__PURE__*/_jsx(SignupPage,{onLogin:handleLogin})})}),/*#__PURE__*/_jsx(Route,{path:\"/invitation\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(Layout,{user:user,onLogout:handleLogout,children:/*#__PURE__*/_jsx(InvitationPage,{user:user})})})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(UserDashboard,{initialData:{user:user,watchlists:watchlists,sectorData:sectorData}})})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/login\",element:user!==null&&user!==void 0&&user.is_admin?/*#__PURE__*/_jsx(Navigate,{to:\"/admin/dashboard\",replace:true}):/*#__PURE__*/_jsx(AdminLoginPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{adminOnly:true,children:/*#__PURE__*/_jsx(AdminDashboard,{initialData:window.adminData||{}})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Layout,{user:user,onLogout:handleLogout,children:/*#__PURE__*/_jsx(ErrorPage,{})})})]})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Navigate","Layout","LandingPage","LoginPage","AdminLoginPage","SignupPage","InvitationPage","ErrorPage","UserDashboard","AdminDashboard","jsx","_jsx","jsxs","_jsxs","App","user","setUser","loading","setLoading","watchlists","setWatchlists","sectorData","setSectorData","fetchUserData","response","fetch","ok","data","json","error","console","handleLogin","userData","handleLogout","ProtectedRoute","_ref","children","adminOnly","className","style","minHeight","role","to","replace","is_admin","code","title","message","path","element","onLogout","onLogin","initialData","window","adminData"],"sources":["/workspaces/Trade25/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\n\n// Layout\nimport Layout from './components/layout/Layout';\n\n// Pages\nimport LandingPage from './components/pages/LandingPage';\nimport LoginPage from './components/pages/LoginPage';\nimport AdminLoginPage from './components/pages/AdminLoginPage';\nimport SignupPage from './components/pages/SignupPage';\nimport InvitationPage from './components/pages/InvitationPage';\nimport ErrorPage from './components/pages/ErrorPage';\n\n// Dashboards\nimport UserDashboard from './components/user/UserDashboard';\nimport AdminDashboard from './components/admin/AdminDashboard';\n\nconst App = () => {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [watchlists, setWatchlists] = useState([]);\n    const [sectorData, setSectorData] = useState({});\n\n    useEffect(() => {\n        // Check for existing session\n        fetchUserData();\n    }, []);\n\n    const fetchUserData = async () => {\n        try {\n            const response = await fetch('/api/auth/me');\n            if (response.ok) {\n                const data = await response.json();\n                setUser(data.user);\n                setWatchlists(data.watchlists || []);\n                setSectorData(data.sectorData || {});\n            }\n        } catch (error) {\n            console.error('Failed to fetch user data:', error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleLogin = (userData) => {\n        setUser(userData);\n        fetchUserData(); // Refresh all data after login\n    };\n\n    const handleLogout = () => {\n        setUser(null);\n        setWatchlists([]);\n        setSectorData({});\n    };\n\n    // Protected Route Component\n    const ProtectedRoute = ({ children, adminOnly = false }) => {\n        if (loading) {\n            return (\n                <div className=\"d-flex justify-content-center align-items-center\" style={{ minHeight: '50vh' }}>\n                    <div className=\"spinner-border text-primary\" role=\"status\">\n                        <span className=\"visually-hidden\">Loading...</span>\n                    </div>\n                </div>\n            );\n        }\n\n        if (!user) {\n            return <Navigate to=\"/login\" replace />;\n        }\n\n        if (adminOnly && !user.is_admin) {\n            return <ErrorPage code=\"403\" title=\"Access Forbidden\" message=\"You don't have permission to access this page.\" />;\n        }\n\n        return children;\n    };\n\n    if (loading) {\n        return (\n            <div className=\"d-flex justify-content-center align-items-center\" style={{ minHeight: '100vh' }}>\n                <div className=\"spinner-border text-primary\" role=\"status\">\n                    <span className=\"visually-hidden\">Loading...</span>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <Router>\n            <Routes>\n                {/* Root Route - Redirect based on auth */}\n                <Route \n                    path=\"/\" \n                    element={\n                        user ? <Navigate to=\"/dashboard\" replace /> : <Navigate to=\"/login\" replace />\n                    } \n                />\n                <Route \n                    path=\"/login\" \n                    element={\n                        user ? <Navigate to=\"/dashboard\" replace /> : (\n                            <Layout user={user} onLogout={handleLogout}>\n                                <LoginPage onLogin={handleLogin} />\n                            </Layout>\n                        )\n                    } \n                />\n                <Route \n                    path=\"/signup\" \n                    element={\n                        user ? <Navigate to=\"/dashboard\" replace /> : (\n                            <Layout user={user} onLogout={handleLogout}>\n                                <SignupPage onLogin={handleLogin} />\n                            </Layout>\n                        )\n                    } \n                />\n\n                {/* Invitation Page */}\n                <Route \n                    path=\"/invitation\" \n                    element={\n                        <ProtectedRoute>\n                            <Layout user={user} onLogout={handleLogout}>\n                                <InvitationPage user={user} />\n                            </Layout>\n                        </ProtectedRoute>\n                    } \n                />\n\n                {/* Protected User Routes */}\n                <Route \n                    path=\"/dashboard\" \n                    element={\n                        <ProtectedRoute>\n                            <UserDashboard \n                                initialData={{\n                                    user: user,\n                                    watchlists: watchlists,\n                                    sectorData: sectorData\n                                }}\n                            />\n                        </ProtectedRoute>\n                    } \n                />\n\n                {/* Admin Routes */}\n                <Route \n                    path=\"/admin/login\" \n                    element={\n                        user?.is_admin ? <Navigate to=\"/admin/dashboard\" replace /> : \n                        <AdminLoginPage />\n                    } \n                />\n                <Route \n                    path=\"/admin/dashboard\" \n                    element={\n                        <ProtectedRoute adminOnly={true}>\n                            <AdminDashboard \n                                initialData={window.adminData || {}}\n                            />\n                        </ProtectedRoute>\n                    } \n                />\n\n                {/* 404 Route */}\n                <Route \n                    path=\"*\" \n                    element={\n                        <Layout user={user} onLogout={handleLogout}>\n                            <ErrorPage />\n                        </Layout>\n                    } \n                />\n            </Routes>\n        </Router>\n    );\n};\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}